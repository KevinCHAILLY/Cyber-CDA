# ModSecurity Exclusions for DVWA Lab
# These exclusions prevent false positives while allowing students to learn

# Disable rule 942100 for DVWA login page to allow SQLi testing
SecRule REQUEST_FILENAME "@streq /login.php" \
    "id:10000,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=942100"

# Disable rule 941180 for DVWA XSS pages to allow XSS testing
SecRule REQUEST_FILENAME "@pm /vulnerabilities/xss_r/ /vulnerabilities/xss_s/ /vulnerabilities/xss_d/" \
    "id:10001,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=941180"

# Disable rule 932100 for DVWA command injection page
SecRule REQUEST_FILENAME "@streq /vulnerabilities/exec/" \
    "id:10002,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=932100"

# Disable rule 930120 for DVWA file inclusion page
SecRule REQUEST_FILENAME "@streq /vulnerabilities/fi/" \
    "id:10003,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=930120"

# Allow specific DVWA parameters that would normally trigger CRS rules
SecRule REQUEST_FILENAME "@pm /vulnerabilities/ /security.php /setup.php" \
    "id:10004,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetById=942100;ARGS:username,\
    ctl:ruleRemoveTargetById=942100;ARGS:password,\
    ctl:ruleRemoveTargetById=942100;ARGS:Login,\
    ctl:ruleRemoveTargetById=941180;ARGS:name,\
    ctl:ruleRemoveTargetById=932100;ARGS:ip,\
    ctl:ruleRemoveTargetById=932100;ARGS:Submit,\
    ctl:ruleRemoveTargetById=930120;ARGS:page"